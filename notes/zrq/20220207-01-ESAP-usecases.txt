#
# <meta:header>
#   <meta:licence>
#     Copyright (c) 2022, ROE (http://www.roe.ac.uk/)
#
#     This information is free software: you can redistribute it and/or modify
#     it under the terms of the GNU General Public License as published by
#     the Free Software Foundation, either version 3 of the License, or
#     (at your option) any later version.
#
#     This information is distributed in the hope that it will be useful,
#     but WITHOUT ANY WARRANTY; without even the implied warranty of
#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#     GNU General Public License for more details.
#
#     You should have received a copy of the GNU General Public License
#     along with this program.  If not, see <http://www.gnu.org/licenses/>.
#   </meta:licence>
# </meta:header>
#
#

Execution platform options

    Portainer

        Portainer REST API provides proxied access to Docker REST API.
        Portainer browser GUI is broken by design :-(
        Needs client code to create the service API we need.

        task-type: oci-container, docker-container

    JupyterHub

        JupyterHub/Binder interface provides some support for individual notebooks.
        Needs more work to test how the interface loads requirements files.

        task-type: jupyter-notebook

Rucio data access

    Do we have a way to refer to data in a DataLake.

        rucio://escape.eu/domain/path ...

Summary of use cases

    ESFRI: CTA
    https://project.escape2020.de/projects/esfri-cta

         4 Software products
        14 use cases

        CTA interactive

            Data is selected from DataLake.
            Software is packaged as JP notebooks.
            task-type: jupyter-notebook

        CTA batch
            Data is selected from DataLake.
            Depends on how the software is packaged.
            Is this using containers on Dirac ?

        Needs a mapping to put the selected data in the right place for the software to find it.
        Implied requirement that the execution platform has access to a DataLake.

    ESFRI: EGO-Virgo
    https://project.escape2020.de/projects/esfri-ego-virgo

        1 use case
        Batch workflows for gravitational wave (GW) pipelines.

        Deployment choice is Kubernetes running the containers,
        from which a pilot project is ongoing at CNAF.

        Interesting to see how this is implemented.
        No links to source code that I could find.

        Delegate to a new task type.
        task-type: [kubernetes-kubectl | kubernetes-helm]


    ESFRI: ESO
    https://project.escape2020.de/projects/esfri-eso

        5 use cases

        Select Tbytes of data (passed by reference not value)

        Needs a way to refer to data in *a* (not the) DataLake.

            rucio://eso.eu/domain/path ...

        Process the raw science data and calibrations into products using the dedicated ESO pipelines
        Specifically, using the ESO Reflex environment (https://www.eso.org/sci/software/esoreflex).
        Java command line and GUI application for managing workflows.

        Need to start a conversation about how they would want to use the software.
        * Run the workflow tool remotely in a container?
        * Run the workflow tool locally, and communocate with steps in containers?

        Using generic containers?
        task-type: docker-container

        Delegate to a new task type?
        task-type: eso-reflex


    ESFRI: FAIR
    https://project.escape2020.de/projects/esfri-fair

        3 Software products

        Simulation, reconstruction and analysis framework that is based on the ROOT system.
        Need to start a conversation about how they would want to use the software.

        Using generic containers?
        task-type: docker-container

        Delegate to a new task type?
        task-type: fair-root

    ESFRI: HL-LHC
    https://project.escape2020.de/projects/esfri-hl-lhc

        No requirements for ESAP.

    ESFRI: JIVE
    https://project.escape2020.de/projects/esfri-jive

        No use cases

    ESFRI: KM3NeT
    https://project.escape2020.de/projects/esfri-2

        2 use cases
        Notebooks using km3py Python package
        task-type: jupyter-notebook

        CORSIKA containers on Dirac (with CTA)
            Containers provided in the OSSR
            GUI for container creation
            Data generated by the CORSIKA simulation (output)
            CORSIKA setup and runcards
            Need to start conversation about the details.

        Using generic containers?
        task-type: docker-container

        Delegate to a new task type?
        task-type: dirac-task


    ESFRI: LOFAR
    https://project.escape2020.de/projects/esfri-lofar

        3 use cases
        Mostly DataLake data handling.
        No specific requirements for ESAP ?

    ESFRI: LSST
    https://project.escape2020.de/projects/esfri-lsst

        No use cases

    ESFRI: SKA
    https://project.escape2020.de/projects/esfri-ska

        Select data from DataLake, select notebook from OSSR.
        task-type: jupyter-notebook

        Select data from DataLake, select containerised workflow from OSSR.
        Need to start conversation about what software they want to use.
        task-type: oci-container, docker-container



